

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing a problem description &mdash; CartesIO 2.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="CartesIO 2.0.0 documentation" href="index.html"/>
        <link rel="next" title="Cartesian task" href="tasks/cartesian.html"/>
        <link rel="prev" title="Design notes" href="design.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CartesIO
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Design and usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design notes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing a problem description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#yaml-basic-structure">YAML basic structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-common-parameters">Task common parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#type">type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#name">name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#active">active</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lambda">lambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lambda2">lambda2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#weight">weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indices">indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disabled-joints">disabled_joints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabled-joints">enabled_joints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lib-name">lib_name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#task-definition-example">Task definition example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-task-types">Supported task types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tasks/cartesian.html">Cartesian task</a></li>
<li class="toctree-l3"><a class="reference internal" href="tasks/postural.html">Postural task</a></li>
<li class="toctree-l3"><a class="reference internal" href="tasks/limits.html">JointLimits</a></li>
<li class="toctree-l3"><a class="reference internal" href="tasks/limits.html#velocitylimits">VelocityLimits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#splitting-tasks-into-subtasks">Splitting tasks into subtasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specifying-tasks-as-constraints">Specifying tasks as constraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rosapi.html">Auto-generated ROS API</a></li>
<li class="toctree-l1"><a class="reference internal" href="progr_cpp.html">Programmatic API (C++)</a></li>
<li class="toctree-l1"><a class="reference internal" href="progr_py.html">Programmatic API (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">How to expand CartesIO</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference/problem.html">Problem Description API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/trajectory.html">Trajectory Interpolation API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/sdk.html">SDK API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">CartesIO</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Writing a problem description</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/problemdesc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-a-problem-description">
<span id="problem"></span><h1>Writing a problem description<a class="headerlink" href="#writing-a-problem-description" title="Permalink to this headline">¶</a></h1>
<div class="section" id="yaml-basic-structure">
<h2>YAML basic structure<a class="headerlink" href="#yaml-basic-structure" title="Permalink to this headline">¶</a></h2>
<p>The basic structure of a problem description file is comprised by</p>
<ul class="simple">
<li>a <strong>stack</strong> field specifying a list of tasks <em>for each priority layer</em>.
Tasks are declared as <em>labels</em> which are later defined at the bottom of the file.</li>
<li>a <strong>constraints</strong> field specifying bounds for the underlying optimization. Again,
these are declared as textual labels to be defined after.</li>
<li>a task/constraint <strong>definition</strong> part where each textual label declared before is actually
defined</li>
</ul>
<p>For example, a simple stack for a bimanual, redundant manipulation platform could be:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span class="c1">## stack of tasks definition ##</span>

<span class="l l-Scalar l-Scalar-Plain">stack</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;LeftArm&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;RightArm&quot;</span><span class="p p-Indicator">]</span>
    <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&quot;Postural&quot;</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">constraints</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;JointLimits&quot;</span><span class="p p-Indicator">]</span>

<span class="c1">## task and constraint definition ##</span>

<span class="l l-Scalar l-Scalar-Plain">JointLimits</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;JointLimits&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">LeftArm</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Cartesian&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">distal_link</span><span class="p p-Indicator">:</span> <span class="s">&quot;arm1_8&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">RightArm</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Cartesian&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">distal_link</span><span class="p p-Indicator">:</span> <span class="s">&quot;arm2_8&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">Postural</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Postural&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="task-common-parameters">
<h2>Task common parameters<a class="headerlink" href="#task-common-parameters" title="Permalink to this headline">¶</a></h2>
<p>All tasks share a list of common parameters, described below.</p>
<div class="section" id="type">
<h3>type<a class="headerlink" href="#type" title="Permalink to this headline">¶</a></h3>
<p>is the literal name of the task type; a list of natively-supported
types is available <a class="reference internal" href="#supportedtasks"><span class="std std-ref">here</span></a>, whereas <a class="reference internal" href="plugins.html#expand"><span class="std std-ref">this section</span></a>
contains details on how to create <strong>custom types</strong></p>
</div>
<div class="section" id="name">
<h3>name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h3>
<p>is the name of the task, which will be used to interact with the task itself,
both from the programmatic API (C++/Python), and from the ROS api (topics, services, …).
The <code class="docutils literal notranslate"><span class="pre">name</span></code> field is optional, the default depending on the task type.</p>
</div>
<div class="section" id="active">
<h3>active<a class="headerlink" href="#active" title="Permalink to this headline">¶</a></h3>
<p>is a boolean specifying whether the task should be active right from creation,
or not. It defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
<div class="section" id="lambda">
<h3>lambda<a class="headerlink" href="#lambda" title="Permalink to this headline">¶</a></h3>
<p>is the value of the feedback gain for position tracking, as a floating point number
ranging from 0 to 1. Defaults to 1.0.</p>
</div>
<div class="section" id="lambda2">
<h3>lambda2<a class="headerlink" href="#lambda2" title="Permalink to this headline">¶</a></h3>
<p>is the value of the feedback gain for velocity tracking (generally used by second-order controllerd),
as a floating point number ranging from 0 to 1. Defaults to -1, which means that the provided value
shound not be used. A reasonable default is therefore computed based on the value of <code class="docutils literal notranslate"><span class="pre">łambda</span></code>.</p>
</div>
<div class="section" id="weight">
<h3>weight<a class="headerlink" href="#weight" title="Permalink to this headline">¶</a></h3>
<p>is used to give different <em>soft priority</em> to the task <em>degrees of freedom</em>, also w.r.t.
other tasks at the same priority level. It must be either a scalar (e.g. <code class="docutils literal notranslate"><span class="pre">weight:</span> <span class="pre">10.0</span></code>) or a vector
with as many elements as the task size (e.g. <code class="docutils literal notranslate"><span class="pre">weight:</span> <span class="pre">[1.,</span> <span class="pre">1.,</span> <span class="pre">1.,</span> <span class="pre">4.,</span> <span class="pre">4.,</span> <span class="pre">4.]</span></code> for a 6D task). Defaults to
the identity.</p>
</div>
<div class="section" id="indices">
<h3>indices<a class="headerlink" href="#indices" title="Permalink to this headline">¶</a></h3>
<p>extract a subtask from the given vector of indices. For instance, <code class="docutils literal notranslate"><span class="pre">indices:</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code> extracts
the position task from a <em>Cartesian</em> task. Defaults to <code class="docutils literal notranslate"><span class="pre">indices:</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">size-1]</span></code>)</p>
</div>
<div class="section" id="disabled-joints">
<h3>disabled_joints<a class="headerlink" href="#disabled-joints" title="Permalink to this headline">¶</a></h3>
<p>is a vector of joints that should not be used to perform the task</p>
</div>
<div class="section" id="enabled-joints">
<h3>enabled_joints<a class="headerlink" href="#enabled-joints" title="Permalink to this headline">¶</a></h3>
<p>provides a way to specify the disabled_joints in terms of which joints will
be enabled</p>
</div>
<div class="section" id="lib-name">
<h3>lib_name<a class="headerlink" href="#lib-name" title="Permalink to this headline">¶</a></h3>
<p>specifies the library with the definition of the custom task type (see <a class="reference internal" href="plugins.html#expand"><span class="std std-ref">this section</span></a>)</p>
</div>
</div>
<div class="section" id="task-definition-example">
<h2>Task definition example<a class="headerlink" href="#task-definition-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span class="l l-Scalar l-Scalar-Plain">LeftArm</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TaskTypeName</span>
    <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">left_arm</span>
    <span class="l l-Scalar l-Scalar-Plain">active</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">lambda</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
    <span class="l l-Scalar l-Scalar-Plain">weight</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10.0</span>
    <span class="l l-Scalar l-Scalar-Plain">indices</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">,</span> <span class="nv">2</span><span class="p p-Indicator">]</span>
    <span class="l l-Scalar l-Scalar-Plain">lib_name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">libCartesioTaskTypeName.so</span>
    <span class="l l-Scalar l-Scalar-Plain">disabled_joints</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">j_arm1_7</span><span class="p p-Indicator">,</span> <span class="nv">torso_yaw</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="section" id="supported-task-types">
<span id="supportedtasks"></span><h2>Supported task types<a class="headerlink" href="#supported-task-types" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks/cartesian.html">Cartesian task</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks/postural.html">Postural task</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks/limits.html">JointLimits</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks/limits.html#velocitylimits">VelocityLimits</a></li>
</ul>
</div>
</div>
<div class="section" id="splitting-tasks-into-subtasks">
<h2>Splitting tasks into subtasks<a class="headerlink" href="#splitting-tasks-into-subtasks" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">indices</span></code> field is used to select a subtask from a given task. Sometimes,
the user wants to <strong>split</strong> a unique “base” class into multiple subtasks, usually
to assign different priorities to them. In this case, it is necessary that, for instance,
sending references to the “base” task will affect all subtasks.</p>
<p>CartesIO offers the <code class="docutils literal notranslate"><span class="pre">Subtask</span></code> type in order to address this need, as in the following example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span class="l l-Scalar l-Scalar-Plain">ComTask</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Com&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">weight</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="l l-Scalar l-Scalar-Plain">lambda</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.05</span>

<span class="l l-Scalar l-Scalar-Plain">ComXY</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Subtask&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span> <span class="s">&quot;ComTask&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">indices</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">1</span><span class="p p-Indicator">]</span>

<span class="l l-Scalar l-Scalar-Plain">ComZ</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="s">&quot;Subtask&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">task</span><span class="p p-Indicator">:</span> <span class="s">&quot;ComTask&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">indices</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>It is then possible to use the task API to (for instance) enable/disable single subtasks,
or change their weight. The same can of course be done on the “base” task. An example using
the Python API would be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span class="n">com</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">getTask</span><span class="p">(</span><span class="s1">&#39;ComTask&#39;</span><span class="p">)</span>
<span class="n">com_xy</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">getTask</span><span class="p">(</span><span class="s1">&#39;ComXY&#39;</span><span class="p">)</span>
<span class="n">com_z</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">getTask</span><span class="p">(</span><span class="s1">&#39;ComZ&#39;</span><span class="p">)</span>

<span class="n">com_z</span><span class="o">.</span><span class="n">setActivationState</span><span class="p">(</span><span class="n">pyci</span><span class="o">.</span><span class="n">ActivationState</span><span class="o">.</span><span class="n">Disabled</span><span class="p">)</span> <span class="c1"># disable only z dof</span>
<span class="n">com_xy</span><span class="o">.</span><span class="n">setWeight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span> <span class="c1"># set weight only for xy</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-tasks-as-constraints">
<h2>Specifying tasks as constraints<a class="headerlink" href="#specifying-tasks-as-constraints" title="Permalink to this headline">¶</a></h2>
<p>It is possible to turn tasks into constraints by simply listing them inside the
<code class="docutils literal notranslate"><span class="pre">constraints</span></code> field.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tasks/cartesian.html" class="btn btn-neutral float-right" title="Cartesian task" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="design.html" class="btn btn-neutral" title="Design notes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Arturo Laurenzi.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>